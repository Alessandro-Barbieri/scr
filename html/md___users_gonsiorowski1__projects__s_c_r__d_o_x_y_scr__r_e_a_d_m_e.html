<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SCR: README</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SCR
   &#160;<span id="projectnumber">1.1.8</span>
   </div>
   <div id="projectbrief">Scalable Checkpoint/Restart</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md___users_gonsiorowski1__projects__s_c_r__d_o_x_y_scr__r_e_a_d_m_e.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">README </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>======================================================================== </p><h1>Scalable Checkpoint / Restart (SCR) Library </h1>
<p>The Scalable Checkpoint / Restart (SCR) library enables MPI applications to utilize distributed storage on Linux clusters to attain high file I/O bandwidth for checkpointing and restarting large-scale jobs. With SCR, jobs run more efficiently, recompute less work upon a failure, and reduce load on critical shared resources such as the parallel file system.</p>
<p>Detailed usage is provided in the <a href="/doc/scr_users_manual.pdf">user manual</a>. </p><hr/>
 <h2>Dependencies </h2>
<p>SCR depends on a number of other software packages.</p>
<p>Required:</p>
<ul>
<li><a href="http://sourceforge.net/projects/pdsh">pdsh</a> &ndash; parallel remote shell command (pdsh, dshbak) e.g.: ```bash wget <a href="http://downloads.sourceforge.net/project/pdsh/pdsh/pdsh-2.18/pdsh-2.18.tar.bz2">http://downloads.sourceforge.net/project/pdsh/pdsh/pdsh-2.18/pdsh-2.18.tar.bz2</a> bunzip2 pdsh-2.18.tar.bz2 tar -xf pdsh-2.18.tar pushd pdsh-2.18 ./configure &ndash;prefix=/tmp make make install ```</li>
<li><a href="http://search.cpan.org/~sbeck/Date-Manip-6.56">Date::Manip</a> &ndash; Perl module for date/time interpretation e.g.: ```bash yum install perl-Date-Manip ```</li>
<li><a href="http://slurm.schedmd.com/">SLURM</a> &ndash; resource manager</li>
</ul>
<p>Optional:</p>
<ul>
<li><a href="https://github.com/LLNL/libyogrt">libyogrt</a> &ndash; your one get remaining time library<ul>
<li>Enables a running job to determine how much time it has left in its resource allocation.</li>
</ul>
</li>
<li><a href="https://github.com/grondo/io-watchdog">io-watchdog</a> &ndash; tool to catch and terminate hanging jobs<ul>
<li>Spawns a thread that can kill an MPI process (and hence the job) when it detects that the process has not written data is some specified amount of time. This is very useful to catch and kill hanging jobs, so that SCR can restart the job or fetch the latest checkpoint.</li>
</ul>
</li>
<li><a href="http://www.mysql.com">MySQL</a> &ndash; for logging events</li>
</ul>
<p>SCR is designed to be ported to other resource managers, so with some work, one may replace SLURM with something else. Also libyogrt is optional and similarly can be replaced with something else. </p><hr/>
 <h2>Configuration </h2>
<p>Most of the default settings in the SCR library can be adjusted. One may customize default settings via configure options, compile-time defines, or a system configuration file.</p>
<p>In particular, the following parameters likely need to be adjusted for other platforms:</p>
<h3>Cache and control directories:</h3>
<p>It is critical to configure SCR with directory paths it should use for cache and control directories. Each of these directories should correspond to a path leading to a storage device that is local to the compute node. For more information, see the SCR directories section below.</p>
<h3>scr.conf:</h3>
<p>A number of options can and must be specified for an SCR installation. A convenient method to set these parameters is to create a system configuration file. To help you get started, an example config file is provided in scr.conf. Copy this file, customize it with your desired settings, and configure your SCR build to know where to look for it using the &ndash;with-scr-config-file configure option, e.g., </p><pre class="fragment">configure --with-scr-config-file=/etc/scr.conf ...
</pre><h3>libyogrt support:</h3>
<p>If libyogrt is available, specify &ndash;with-yogrt[=PATH] during the configure.</p>
<p>The function of libyogrt is to enable a job to determine how much time it has left in its current allocation. While libyogrt is not available outside of LLNL, other computer centers often have some mechanism that provides similar functionality. It should be straigt- forward to replace calls to libyogrt with something else. One must simply modify the <a class="el" href="scr__env_8c.html#a07e8a487856fbb408199c17bf9c47b5f">scr_env_seconds_remaining()</a> implementation in <a class="el" href="scr__env_8c.html">src/scr_env.c</a> to return the number of seconds left in the job allocation.</p>
<h3>MySQL DB Logging:</h3>
<p>SCR can log events to a MySQL database. However, this feature is still in development. To enable logging to MySQL, configure with &ndash;with-mysql. If you would like to give it a try, see the scr.mysql file for further instructions.</p>
<p>The compile-time define variables are specified in <a class="el" href="scr__conf_8h.html">src/scr_conf.h</a>. One may modify the settings in this file before building to set different defaults. In many cases, one may be able to avoid having to create a system configuration using this method. </p><hr/>
 <h2>Build and install </h2>
<p>Use the standard, configure/make/make install to configure, build, and install the library, e.g.: </p><pre class="fragment">./configure \
  --prefix=/usr/local/tools/scr-1.1 \
  --with-scr-config-file=/etc/scr.conf
make
make install
</pre><p>To uninstall the installation: </p><pre class="fragment">make uninstall
</pre><p>SCR is layered on top of MPI, and it must be built with the MPI library used by the application. It uses the standard mpicc compiler wrapper. If there are multiple MPI libraries, a separate SCR library must be built for each MPI library.</p>
<p>If you are using the scr.conf file, you'll also need to edit this file to match the settings on your system. Please open this file and make any necessary changes &ndash; it is self-documented with comments. After modifying this file, copy it to the location specified in your configure step. The configure option simply informs the SCR install where to look for the file, it does not modify or install the file.</p>
<h3>Example Programs</h3>
<p>The test programs included in the examples directory will be installed to <code>${SCR_INSTALL}/share/scr/examples</code>. They are built in this directory with <code>make</code>. </p><hr/>
 <h2>SCR directories </h2>
<p>There are three types of directories where SCR manages files.</p>
<h3>(1) Cache directory</h3>
<p>SCR instructs the application to write its checkpoint files to a cache directory, and SCR computes and stores redundancy data here. SCR can be configured to use more than one cache directory in a single run. The cache directory must be local to the compute node.</p>
<p>The cache directory must be large enough to hold at least one full application checkpoint. However, it is better if the cache is large enough to store at least two checkpoints. When using storage local to the compute node, the cache must be roughly 0.5x-3x the size of the node's memory to be effective.</p>
<p>The library is hard-coded to use /tmp as the cache directory. To change this location, do any of the following:</p>
<ul>
<li>change the SCR_CACHE_BASE value in <a class="el" href="scr__conf_8h.html">src/scr_conf.h</a>,</li>
<li>specify the new path during configure using the &ndash;with-scr-cache-base=PATH option,</li>
<li>or set the value in a system configuration file.</li>
</ul>
<p>To enable multiple cache directories, one must use a system configuration file.</p>
<h3>(2) Control directory</h3>
<p>SCR stores files to track its internal state in the control directory. Currently, this directory must be local to the compute node. Files written to the control directory are small and they are read and written to frequently, so RAM disk works well for this. There are a variety of files kept in the control directory. For some of these files, all processes maintain their own file, and for others, only rank 0 accesses the file.</p>
<p>The library is hard-coded to use /tmp as the control directory. To change this location, do any of the following:</p>
<ul>
<li>change the SCR_CNTL_BASE value in <a class="el" href="scr__conf_8h.html">src/scr_conf.h</a>,</li>
<li>specify the new path during configure using the &ndash;with-scr-cntl-base=PATH option,</li>
<li>or set the value in a system configuration file.</li>
</ul>
<h3>(3) Prefix directory - on parallel file system</h3>
<p>This is the directory where SCR will fetch and flush checkpoint sets to the parallel file system.</p>
<p>The prefix directory defaults to the current working directory of the application. To override this, the user can set the SCR_PREFIX parameter at run time. </p><hr/>
 <h2>RAM disk </h2>
<p>On systems where compute nodes are diskless, often RAM disk is the only option for a checkpoint cache. When using RAM disk, one should configure the Linux hard limit to be around two-thirds of the amount of memory on a node. This is a high limit, however Linux only allocates space as needed, so it is safe to use a high setting. Jobs which do not use RAM disk will not be negatively affected by using a high setting. This setting must be set by the system administrators. </p><hr/>
 <h2>Nodeset format </h2>
<p>Several of the commands process the nodeset allocated to the job. The node names are expected to be of the form: </p><pre class="fragment">clustername#
</pre><p>where clustername is a string of letters common for all nodes, and # is the node number, like atlas35 and atlas173.</p>
<p>More generally:</p>
<p>&lt;any non="" digit="" characters&gt;=""&gt;&lt;any digit="" characters&gt;=""&gt;</p>
<p>so things like atlas-31, atlas31, or even $$##$!21 are all valid.</p>
<p>What is currently not valid is something like:</p>
<p>atlas-31vm1</p>
<p>because this breaks the regular expressions since it only expects digits characters after the non digit characters. This limitation may be further generalized in the future.</p>
<p>The scr_hostlist.pm perl module compresses lists of such nodenames into a form like so: </p><pre class="fragment">atlas[31-43,45,48-51]
</pre><hr/>
 <h2>Authors </h2>
<p>Numerous people have <a href="https://github.com/llnl/scr/graphs/contributors">contributed</a> to the SCR project.</p>
<p>To reference SCR in a publication, please cite the following paper:</p>
<ul>
<li>Adam Moody, Greg Bronevetsky, Kathryn Mohror, Bronis R. de Supinski, <a href="http://dl.acm.org/citation.cfm?id=1884666">Design, Modeling, and Evaluation of a Scalable Multi-level Checkpointing System</a>, LLNL-CONF-427742, Supercomputing 2010, New Orleans, LA, November 2010.</li>
</ul>
<p>Additional information and research publications can be found here:</p>
<p><a href="http://computation.llnl.gov/projects/scalable-checkpoint-restart-for-mpi">http://computation.llnl.gov/projects/scalable-checkpoint-restart-for-mpi</a> </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.12 </li>
  </ul>
</div>
</body>
</html>
